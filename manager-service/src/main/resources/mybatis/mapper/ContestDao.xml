<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.cloudli.managerservice.dao.ContestDao">
    <select id="getCount" resultType="java.lang.Long">
        select count(contest_id)
        from contest
    </select>

    <select id="getAllContest" resultType="top.cloudli.managerservice.model.Contest">
        select *
        from contest
        limit #{start}, #{limit}
    </select>

    <select id="getProblemsCount" resultType="java.lang.Long">
        select count(*)
        from contest_problem
        where contest_id = #{contestId}
    </select>

    <select id="getProblems" resultType="top.cloudli.managerservice.model.Problem">
        select *
        from contest_problem
        where contest_id = #{contestId}
        limit #{start}, #{limit}
    </select>

    <insert id="addContest" parameterType="top.cloudli.managerservice.model.Contest">
        insert into contest(contest_name, start_at, end_at)
            value (#{contestName}, #{startAt}, #{endAt})
    </insert>

    <delete id="deleteContest">
        delete
        from contest
        where contest_id = #{contestId}
    </delete>

    <insert id="addProblem">
        insert into `contest-problem`(contest_id, problem_id)
            value (#{contestId}, #{problemId})
    </insert>

    <delete id="deleteProblem">
        delete
        from `contest-problem`
        where contest_id = #{contestId}
          and problem_id = #{problemId}
    </delete>
</mapper>